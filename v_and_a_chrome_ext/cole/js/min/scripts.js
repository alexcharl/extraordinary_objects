function PointerEventsPolyfill(e){var n;this.options={selector:"*",mouseEvents:["click","dblclick","mousedown","mouseup"],usePolyfillIf:function(){if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;if(null!=e.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/))if(parseFloat(RegExp.$1)<11)return!0}return!1}},e&&(n=this,$.each(e,function(e,t){n.options[e]=t})),this.options.usePolyfillIf()&&this.register_mouse_events()}(()=>{for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=n.length,o=window.console=window.console||{};i--;)o[e=n[i]]||(o[e]=t)})(),window.Modernizr=function(e,h,d){function t(e){c.cssText=e}function u(e,t){return typeof e===t}function i(e,t){return!!~(""+e).indexOf(t)}function f(e,t){for(var n in e){n=e[n];if(!i(n,"-")&&c[n]!==d)return"pfx"!=t||n}return!1}function o(e,t,n){var i=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+v.join(i+" ")+i).split(" ");if(u(t,"string")||void 0===t)return f(o,t);var r,s=(e+" "+y.join(i+" ")+i).split(" "),a=t,c=n;for(r in s){var l=a[s[r]];if(l!==d)return!1===c?s[r]:u(l,"function")?l.bind(c||a):l}return!1}function r(e,t,n,i){var o,r,s,a=h.createElement("div"),c=h.body,l=c||h.createElement("body");if(parseInt(n,10))for(;n--;)(r=h.createElement("div")).id=i?i[n]:p+(n+1),a.appendChild(r);return o=["&#173;",'<style id="s',p,'">',e,"</style>"].join(""),a.id=p,(c?a:l).innerHTML+=o,l.appendChild(a),c||(l.style.background="",l.style.overflow="hidden",s=m.style.overflow,m.style.overflow="hidden",m.appendChild(l)),o=t(a,e),c?a.parentNode.removeChild(a):(l.parentNode.removeChild(l),m.style.overflow=s),!!o}var n,s,a={},m=h.documentElement,p="modernizr",c=h.createElement(p).style,l=" -webkit- -moz- -o- -ms- ".split(" "),g="Webkit Moz O ms",v=g.split(" "),y=g.toLowerCase().split(" "),b={},w=[],E=w.slice,j={}.hasOwnProperty,C=void 0!==j&&void 0!==j.call?function(e,t){return j.call(e,t)}:function(e,t){return t in e&&void 0===e.constructor.prototype[t]};for(s in Function.prototype.bind||(Function.prototype.bind=function(n){var i=this;if("function"!=typeof i)throw new TypeError;var o=E.call(arguments,1),r=function(){var e,t;return this instanceof r?((e=function(){}).prototype=i.prototype,e=new e,t=i.apply(e,o.concat(E.call(arguments))),Object(t)===t?t:e):i.apply(n,o.concat(E.call(arguments)))};return r}),b.canvas=function(){var e=h.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},b.touch=function(){var t;return"ontouchstart"in e||e.DocumentTouch&&h instanceof DocumentTouch?t=!0:r(["@media (",l.join("touch-enabled),("),p,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){t=9===e.offsetTop}),t},b.rgba=function(){return t("background-color:rgba(150,255,150,.5)"),i(c.backgroundColor,"rgba")},b.cssanimations=function(){return o("animationName")},b.csstransforms=function(){return!!o("transform")},b.csstransforms3d=function(){var n=!!o("perspective");return n&&"webkitPerspective"in m.style&&r("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e,t){n=9===e.offsetLeft&&3===e.offsetHeight}),n},b.csstransitions=function(){return o("transition")},b)C(b,s)&&(n=s.toLowerCase(),a[n]=b[s](),w.push((a[n]?"":"no-")+n));a.addTest=function(e,t){if("object"==typeof e)for(var n in e)C(e,n)&&a.addTest(n,e[n]);else{if(e=e.toLowerCase(),a[e]!==d)return a;t="function"==typeof t?t():t,m.className+=" "+(t?"":"no-")+e,a[e]=t}return a},t("");var g=this,T=h;function k(){var e=M.elements;return"string"==typeof e?e.split(" "):e}function L(e){var t=H[e[_]];return t||(t={},O++,e[_]=O,H[O]=t),t}function x(e,t,n){return t=t||T,$?t.createElement(e):!(t=(n=n||L(t)).cache[e]?n.cache[e].cloneNode():z.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e)).canHaveChildren||N.test(e)||t.tagUrn?t:n.frag.appendChild(t)}function I(e){var t,n,i,o,r,s=L(e=e||T);return!M.shivCSS||P||s.hasCSS||(s.hasCSS=(o="article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}",r=(i=e).createElement("p"),i=i.getElementsByTagName("head")[0]||i.documentElement,r.innerHTML="x<style>"+o+"</style>",!!i.insertBefore(r.lastChild,i.firstChild))),$||(t=e,(n=s).cache||(n.cache={},n.createElem=t.createElement,n.createFrag=t.createDocumentFragment,n.frag=n.createFrag()),t.createElement=function(e){return M.shivMethods?x(e,t,n):n.createElem(e)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+k().join().replace(/[\w\-]+/g,function(e){return n.createElem(e),n.frag.createElement(e),'c("'+e+'")'})+");return n}")(M,n.frag)),e}var P,$,S,A=g.html5||{},N=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,z=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,_="_html5shiv",O=0,H={};try{var D=T.createElement("a");D.innerHTML="<xyz></xyz>",P="hidden"in D,$=1==D.childNodes.length||(T.createElement("a"),void 0===(S=T.createDocumentFragment()).cloneNode)||void 0===S.createDocumentFragment||void 0===S.createElement}catch(e){$=P=!0}var M={elements:A.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==A.shivCSS,supportsUnknownElements:$,shivMethods:!1!==A.shivMethods,type:"default",shivDocument:I,createElement:x,createDocumentFragment:function(e,t){if(e=e||T,$)return e.createDocumentFragment();for(var n=(t=t||L(e)).frag.cloneNode(),i=0,o=k(),r=o.length;i<r;i++)n.createElement(o[i]);return n}};return g.html5=M,I(T),a._version="2.7.1",a._prefixes=l,a._domPrefixes=y,a._cssomPrefixes=v,a.testProp=function(e){return f([e])},a.testAllProps=o,a.testStyles=r,m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(" js "+w.join(" ")),a}(this,this.document),(u=>{var f={},n="doTimeout",m=Array.prototype.slice;function i(e){var t,n=this,i={},o=e?u.fn:u,r=arguments,s=4,a=r[1],c=r[2],l=r[3];function h(){e?t.removeData(e):a&&delete f[a]}function d(){i.id=setTimeout(function(){i.fn()},c)}if("string"!=typeof a&&(s--,a=e=0,c=r[1],l=r[2]),e?(t=n.eq(0)).data(e,i=t.data(e)||{}):a&&(i=f[a]||(f[a]={})),i.id&&clearTimeout(i.id),delete i.id,l)i.fn=function(e){(!0!==(l="string"==typeof l?o[l]:l).apply(n,m.call(r,s))||e?h:d)()},d();else{if(i.fn)return void 0===c?h():i.fn(!1===c),!0;h()}}u[n]=function(){return i.apply(window,[0].concat(m.call(arguments)))},u.fn[n]=function(){var e=m.call(arguments),t=i.apply(this,[n+e[0]].concat(e));return"number"==typeof e[0]||"number"==typeof e[1]?this:t}})(jQuery),((e,h)=>{var i,t=e.jQuery||e.Cowboy||(e.Cowboy={});t.throttle=i=function(o,r,s,a){var c,l=0;function e(){var e=this,t=+new Date-l,n=arguments;function i(){l=+new Date,s.apply(e,n)}a&&!c&&i(),c&&clearTimeout(c),a===h&&o<t?i():!0!==r&&(c=setTimeout(a?function(){c=h}:i,a===h?o-t:o))}return"boolean"!=typeof r&&(a=s,s=r,r=h),t.guid&&(e.guid=s.guid=s.guid||t.guid++),e},t.debounce=function(e,t,n){return n===h?i(e,t,!1):i(e,n,!1!==t)}})(this),PointerEventsPolyfill.initialize=function(e){return null==PointerEventsPolyfill.singleton&&(PointerEventsPolyfill.singleton=new PointerEventsPolyfill(e)),PointerEventsPolyfill.singleton},PointerEventsPolyfill.prototype.register_mouse_events=function(){$(document).on(this.options.mouseEvents.join(" "),this.options.selector,function(e){var t,n;return"none"!=$(this).css("pointer-events")||(t=$(this).css("display"),$(this).css("display","none"),n=document.elementFromPoint(e.clientX,e.clientY),t?$(this).css("display",t):$(this).css("display",""),e.target=n,$(n).trigger(e),!1)})},function(){function e(){}function r(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function t(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,i=this,o=i.EventEmitter;n.getListeners=function(e){var t,n,i=this._getEvents();if("object"==typeof e)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},n.flattenListeners=function(e){for(var t=[],n=0;e.length>n;n+=1)t.push(e[n].listener);return t},n.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},n.addListener=function(e,t){var n,i=this.getListenersAsObject(e),o="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===r(i[n],t)&&i[n].push(o?t:{listener:t,once:!1});return this},n.on=t("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=t("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,t){var n,i,o=this.getListenersAsObject(e);for(i in o)o.hasOwnProperty(i)&&(n=r(o[i],t),-1!==n)&&o[i].splice(n,1);return this},n.off=t("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,n){var i,o,r=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)r.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(o=t[i])&&("function"==typeof o?r:s).call(this,i,o);return this},n.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"==n)delete i[e];else if("object"==n)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},n.removeAllListeners=t("removeEvent"),n.emitEvent=function(e,t){var n,i,o,r,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=s[o].length;i--;)n=s[o][i],!0===n.once&&this.removeListener(e,n.listener),r=n.listener.apply(this,t||[]),r===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},n.trigger=t("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=o,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),(n=>{function i(e){var t=n.event;return t.target=t.target||t.srcElement||e,t}var e=document.documentElement,t=function(){},o=(e.addEventListener?t=function(e,t,n){e.addEventListener(t,n,!1)}:e.attachEvent&&(t=function(t,e,n){t[e+n]=n.handleEvent?function(){var e=i(t);n.handleEvent.call(n,e)}:function(){var e=i(t);n.call(t,e)},t.attachEvent("on"+e,t[e+n])}),function(){}),e=(e.removeEventListener?o=function(e,t,n){e.removeEventListener(t,n,!1)}:e.detachEvent&&(o=function(t,n,i){t.detachEvent("on"+n,t[n+i]);try{delete t[n+i]}catch(e){t[n+i]=void 0}}),{bind:t,unbind:o});"function"==typeof define&&define.amd?define("eventie/eventie",e):n.eventie=e})(this),((n,i)=>{"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(e,t){return i(n,e,t)}):"object"==typeof exports?module.exports=i(n,require("eventEmitter"),require("eventie")):n.imagesLoaded=i(n,n.EventEmitter,n.eventie)})(this,function(e,t,n){function o(e,t){for(var n in t)e[n]=t[n];return e}function r(e){var t=[];if("[object Array]"===d.call(e))t=e;else if("number"==typeof e.length)for(var n=0,i=e.length;n<i;n++)t.push(e[n]);else t.push(e);return t}function s(e,t,n){if(!(this instanceof s))return new s(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=r(e),this.options=o({},this.options),"function"==typeof t?n=t:o(this.options,t),n&&this.on("always",n),this.getImages(),c&&(this.jqDeferred=new c.Deferred);var i=this;setTimeout(function(){i.check()})}function i(e){this.img=e}function a(e){this.src=e,u[e]=this}var c=e.jQuery,l=e.console,h=void 0!==l,d=Object.prototype.toString,u=((s.prototype=new t).options={},s.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;e<t;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),o=0,r=i.length;o<r;o++){var s=i[o];this.addImage(s)}}},s.prototype.addImage=function(e){e=new i(e);this.images.push(e)},s.prototype.check=function(){function e(e,t){return n.options.debug&&h&&l.log("confirm",e,t),n.progress(e),++i===o&&n.complete(),!0}var n=this,i=0,o=this.images.length;if(this.hasAnyBroken=!1,o)for(var t=0;t<o;t++){var r=this.images[t];r.on("confirm",e),r.check()}else this.complete()},s.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done",n=(this.isComplete=!0,this);setTimeout(function(){var e;n.emit(t,n),n.emit("always",n),n.jqDeferred&&(e=n.hasAnyBroken?"reject":"resolve",n.jqDeferred[e](n))})},c&&(c.fn.imagesLoaded=function(e,t){return new s(this,e,t).jqDeferred.promise(c(this))}),(i.prototype=new t).check=function(){var n,e=u[this.img.src]||new a(this.img.src);e.isConfirmed?this.confirm(e.isLoaded,"cached was confirmed"):this.img.complete&&void 0!==this.img.naturalWidth?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(n=this,e.on("confirm",function(e,t){return n.confirm(e.isLoaded,t),!0}),e.check())},i.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)},{});return(a.prototype=new t).check=function(){var e;this.isChecked||(e=new Image,n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0)},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},a.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},a.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},a.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},s}),(t=>{t.fn.fittr=function(e){window.console&&window.console.log;var c=t.extend({container:"div",imgWidth:0,imgHeight:0,containerWidth:0,containerHeight:0,gap:{vertical:0,horizontal:0},align:{vertical:"top",horizontal:"left"},resizeType:"fit",autoResize:!0,forceDebounce:!1},e);return c.gap.vertical||(c.gap.vertical=0),c.gap.horizontal||(c.gap.horizontal=0),c.align.vertical||(c.align.vertical="top"),c.align.horizontal||(c.align.horizontal="left"),this.each(function(){var r=t(this),s=r.parents(c.container).first(),a=1;function e(){var e={width:0<parseInt(r.attr("width"))?parseInt(r.attr("width")):r.width(),height:0<parseInt(r.attr("height"))?parseInt(r.attr("height")):r.height()},t=0<c.imgWidth?c.imgWidth:e.width,e=0<c.imgHeight?c.imgHeight:e.height,n=0<c.containerWidth?c.containerWidth:s.width(),i=0<c.containerHeight?c.containerHeight:s.height(),o={width:n-c.gap.horizontal,height:i-c.gap.vertical},t=t/e,e=o.width/o.height;e="fit"==c.resizeType?{width:o.width<=o.height*t?o.width:o.height*t,height:o.width<=o.height*t?o.width/t:o.height,marginLeft:0,marginTop:0}:(s.css("overflow","hidden"),{width:e<=t?o.height*t:o.width,height:e<=t?o.height:o.width/t,marginLeft:0,marginTop:0}),"right"==c.align.horizontal?e.marginLeft=n-e.width:"center"==c.align.horizontal&&(e.marginLeft=(n-e.width)/2),"bottom"==c.align.vertical?e.marginTop=i-e.height:"middle"==c.align.vertical&&(e.marginTop=(i-e.height)/2),r.css(e),a++}e(),1==c.autoResize&&(10<a||1==c.forceDebounce?t(window).smartresize(e):t(window).resize(e))})}})(jQuery),(t=>{jQuery.fn[t]=function(e){return e?this.bind("resize",(n=e,function(){var e=this,t=arguments;r?clearTimeout(r):o&&n.apply(e,t),r=setTimeout(function(){o||n.apply(e,t),r=null},i||100)})):this.trigger(t);var n,i,o,r}})((jQuery,"smartresize"));var pumkin=window.pumkin={};((t,C,n)=>{pumkin={getTransformValues:function(e,t){var n=(e=e.css("transform").match(/-?[0-9\.]+/g))[0];return"scale"===t?n:"translate"===t?{x:e[4]/n,y:e[5]/n}:"raw"===t?e:void 0},checkKey:function(e){return(e=e||t.event).keyCode},svgFallback:function(){C("img[src$='.svg']").each(function(){var e=C(this),t=e.attr("src").replace(".svg",".png");e.attr("src",t)})},normalizeBoxHeights:function(e){var t=0;e.each(function(){t=Math.max(C(this).height(),t)}),e.each(function(){C(this).height(t)})},randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},autoFit:function(e,t,n,i,o,r,s){console.log("autoFit: "+t.length),n=n||0;for(var a=e.width()-n,c=(t.removeAttr("style"),[]),l=0,h=[],d=(t.each(function(){var e=C(this);(l+=parseInt(e.css("width"))+n)<=a?h.push(e):(c.push(h),h=new Array(e),l=parseInt(e.css("width"))+n),e.is(":last-child")&&o&&c.push(h)}),c.length),u=0;u<d;u++){for(var f=c[u].length,m=0,p=0;p<f;p++)m+=parseInt(c[u][p].css("width"))+n;var g=(a-m)/f,v=m/f,y=0;for(s&&parseInt(c[0][0].css("width")),p=0;p<f;p++){var b,w=parseInt(c[u][p].css("width")),E=s?w+g:w+Math.floor(g*(w/v));0===u&&0===p&&(b=parseInt(c[u][p].css("height")),b=i?Math.floor(E*(b/w)):b),r?c[u][p].css({width:E}):c[u][p].css({width:E,height:b}),y+=E+n}var j=a-y;c[u][f-1].css("width",parseInt(c[u][f-1].css("width"))+j)}},defineDeviceVariables:function(){var e={isMobile:"visible"===C("#mobileTester").css("visibility"),isTablet:"visible"===C("#tabletTester").css("visibility"),isTouch:!!n.touch};return e.isDevice=!(!e.isMobile&&!e.isTablet),e},browserDetection:function(){var e={};return e.isChrome=-1<navigator.userAgent.indexOf("Chrome"),e.isExplorer=-1<navigator.userAgent.indexOf("MSIE"),e.isFirefox=-1<navigator.userAgent.indexOf("Firefox"),e.isSafari=-1<navigator.userAgent.indexOf("Safari"),e.isOpera=-1<navigator.userAgent.indexOf("Presto"),e.isChrome&&e.isSafari&&(e.isSafari=!1),e},makePlaceholders:function(e,n){n=n||"active",C(e).each(function(){var e=C(this),t=e.data().placeholder;e.val(t),""===C.trim(e.val())&&e.val(t).removeClass(n),e.focus(function(){e.val()===t&&e.val("").addClass(n)}).blur(function(){""===C.trim(e.val())&&e.val(t).removeClass(n)})})},intelliLoad:function(e,t,n){n="function"==typeof imagesLoaded&&n,e.each(function(){var e=C(this),t=e.data("src");n&&e.css({opacity:0}),e.attr("src")||(e.attr("src",t),console.log("INTELLILOAD: is image?"+e.is("img")),n&&e.is("img")&&(console.log("INTELLILOAD: revlealOnLoad: "+t),e.imagesLoaded().done(function(e,t){console.log("INTELLILOAD: imagesLoaded: "+t.attr("src")),t.css({opacity:1})})))})}}})(this,this.jQuery,this.Modernizr),((e,t)=>{var n=e.pumkin;(e.SITE=e.SITE||{}).initGlobal=function(){e.gv={$window:t(e),$document:t(document),$html:t("html"),$body:t("body"),WIDTH:t(e).width(),HEIGHT:t(e).height(),deviceVariables:n.defineDeviceVariables(),browser:n.browserDetection(),$wrapper:t("#wrapper")},console.log("initGlobal")}})(this,this.jQuery,this.Modernizr),((t,i,n)=>{t.pumkin;var e=t.SITE=t.SITE||{},o=null,r=null,s=[];function a(){var n,e;i(".history-wrapper .loading").addClass("loaded"),n=0,(e=t.theHistory||s||[])&&0!==e.length?e.forEach(function(e){var t="",t=(t=(t=(t=(t=(t+='<a class="history-object hide-until-loaded" data-object-number="'+e.objectNumber+'" href="'+e.vaCollectionsUrl+'"')+'title="View this item in the V&amp;A archive">'+'<div class="history-object-image-holder" ')+("style=\"background-image: url('"+e.imageUrl+"');\">")+"</div>")+('<img src="'+e.imageUrl+'" class="image-holder-for-loading" id="image-holder-'+n+'" >')+'<div class="history-object-info">')+("<p><strong>"+e.title+"</strong>, "+e.date+"</p>")+("<p>"+e.artist+"</p>"))+"</div>"+"</a>";i("#history-objects").append(t),i("#image-holder-"+n).on("load",function(){i(this).parent().addClass("loaded"),i(this).remove()}),n++}):i("#history-objects").html('<p class="no-history">No objects viewed yet. Start exploring the V&A collection!</p>')}function c(){var e=$textContent.scrollTop();.5*r<e?$objectCaption.addClass("reveal"):$objectCaption.removeClass("reveal"),.5*r<e?$objectHeader.addClass("hide"):$objectHeader.removeClass("hide")}function l(){c()}function h(){o.width(),r=o.height()}function d(){}t.theHistory=s,t.maxHistoryItems=10;var u=i.throttle(250,function(){}),f=i.debounce(100,function(){});e.initMain=function(){var e;e=t.gv,o=e.$window,r=e.HEIGHT,e.deviceVariables.isMobile,e.deviceVariables.isTablet,e.deviceVariables.isDevice,e.deviceVariables.isTouch,$textContent=i(".text-content-column"),$objectCaption=i(".object-caption"),$downArrow=i(".down-arrow"),$objectHeader=i(".object-header"),$sidePanel=i(".side-panel"),$sidePanelOpenBtn=i(".more"),$sidePanelCloseBtn=i(".close-side-panel"),$historyOpenBtn=i(".history"),$overlayCloseBtn=i(".close-overlay"),$overlay=i(".overlay"),$techInfo=i(".technical-info .text-content"),"undefined"!=typeof chrome&&void 0!==chrome.storage&&chrome.storage.local.get(["objectHistory"],function(e){e.objectHistory&&(s=e.objectHistory,t.theHistory=s,console.log("Loaded history from storage:",s.length,"items"))}),void 0!==n&&n&&n.attach(document.body),$sidePanelOpenBtn.click(function(){$sidePanel.hasClass("open")?$sidePanel.removeClass("open"):$sidePanel.addClass("open")}),$sidePanelCloseBtn.click(function(){$sidePanel.removeClass("open")}),$downArrow.click(function(){i(".object-text").velocity("scroll",{duration:700,offset:-100,easing:"ease-in-out",container:$textContent})}),$historyOpenBtn.click(function(){$overlay.hasClass("closed")&&($overlay.removeClass("closed").addClass("open for-history"),a(),$overlay.fadeIn(500))}),$overlayCloseBtn.click(function(){$overlay.fadeOut(500,function(){$overlay.removeClass("open for-history for-warning").addClass("closed")})}),i(".go-to-options").click(function(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():t.open(chrome.runtime.getURL("/src/options/index.html"))}),h(),o.on("resize",h),o.on("resize",u),o.on("resize",f),c(),$textContent.on("scroll",l),console.log("initMain")},e.throwError=function(){$overlay.removeClass("closed").addClass("open for-warning"),$overlay.fadeIn(500)},e.onThrottledResize=d,e.showHistory=a,e.hideHistory=function(){i("#history-objects").text("")}})(this,this.jQuery,(this.Modernizr,this.screenfull,this.FastClick)),((v,y)=>{var t,b,w=v.pumkin,E=v.SITE=v.SITE||{},j="https://collections.vam.ac.uk/item/",n=["Architecture","Asia","British Galleries","Ceramics","Childhood","Contemporary","Fashion","Jewellery","Furniture","Glass","Metalwork","Paintings","Drawings","Photography","Prints","Books","Sculpture","Textiles","Theatre"],h=!1,d=0,u=5;function C(){b=t[w.randomNum(0,t.length)],console.log("Chosen search term: "+b+" from "+t.length+" available terms")}function T(e,t,n,i,o,r,s,a){var c,l;d<u?(d++,e=void 0!==e?e:null,o=void 0!==o?o:"1",i=void 0!==i?i:"1",t=void 0!==t?t:null,n=void 0!==n?n:null,r=void 0!==r?r:"1",s=void 0!==s?s:null,a=void 0!==a?a:"0",quality="undefined"!=typeof quality?quality:null,c=0,null!=n?c=1:null!=e&&(c=2),1==h?(l=t,t=null):l=null,console.log("strictSearch = "+h),console.log("expectResponse = "+c),console.log("Chosen term = "+t),console.log("Chosen item name = "+l),console.log("offset = "+n),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage?(console.log("Sending message to background script..."),chrome.runtime.sendMessage({action:"makeVaRequest",params:{systemNumber:e,searchTerm:t||l,offset:n,limit:i,withImages:o,withDescription:r,after:s,random:a,hasImage:"1"}},function(e){console.log("Received response from background script:",e),e&&e.success?(console.log("API request successful"),f(e.data,c)):(console.log("API request failed:",e?e.error:"No response"),C(),T(null,b))})):(console.log("Running as standalone page - API requests will fail due to CORS"),E.throwError())):(console.log("maximum number of search attempts reached, try changing search terms"),E.throwError())}function f(e,t){if(console.log(e),0===t)0<(n=e.records.length)?(i=w.randomNum(0,e.info.record_count-1),console.log("total results = "+e.info.record_count),console.log("randomOffset range: 0 to "+(e.info.record_count-1)),console.log("generated randomOffset = "+i),console.log("making query 2, with randomOffset of "+i),T(null,b,i)):(console.log("making a second request, no results found last time"),C(),T(null,b));else if(1===t)n=e.records.length,console.log("There are "+n+" objects available."),i=e.records[0].systemNumber,console.log("Selected object system number: "+i),T(i);else if(e.records&&0!==e.records.length){var n=e.records[0],i=(console.log("Processing object data:",n),n._primaryImageId);if(!i||null===i||""===i)if(console.log("Object has no image, skipping to next object"),2===t)C(),T(null,b);else{if(!(1<e.records.length))return console.log("No more objects in search results, trying new search"),C(),void T(null,b);if(console.log("Trying next object in search results"),!(i=(n=e.records[1])._primaryImageId)||null===i||""===i)return console.log("Next object also has no image, trying new search"),C(),void T(null,b)}var e=n.objectType,o=""!=n._primaryTitle?n._primaryTitle:n.objectType,r=n._primaryDate,s=n.systemNumber,a=n._primaryMaker&&n._primaryMaker.name?n._primaryMaker.name:"",c=n.systemNumber,l="",h=(console.log("Extracted data - Title:",o,"Artist:",a,"System Number:",c,"Image ID:",i),""),d=(n._primaryMaker&&n._primaryMaker.birthYear&&(f=n._primaryMaker.birthYear,u=n._primaryMaker.deathYear,f&&u?h="("+f+" - "+u+")":f&&(h="(Born "+f+")")),"https://framemark.vam.ac.uk/collections/"+i+"/full/1000,/0/default.jpg"),u=j+c+"/"+s,f="",i=n._primaryPlace,s=n.accessionNumber,n=n._currentLocation?n._currentLocation.displayName:"",m="<strong>"+(o=(o=(o=(o=(o=o.replace(/\^/,"")).replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,""))+" "+r+"</strong> &mdash; "+a+" "+h,p=[];o&&o!==e&&p.push(o),r&&p.push("Dated "+r),i&&p.push("from "+i),a&&"Unknown"!==a&&p.push("by "+a);l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=(l=0<p.length?p.join(", ")+".":"A "+e+" from the V&A collection.").replace(/Object Type\n/g,"")).replace(/People\n/g,"")).replace(/Place\n/g,"")).replace(/Places\n/g,"")).replace(/Time\n/g,"")).replace(/Design \& Designing\n/g,"")).replace(/Design\n/g,"")).replace(/Subject Depicted\n/g,"")).replace(/Subjects Depicted\n/g,"")).replace(/Materials \& Making\n/g,"")).replace(/Collectors \& Owners\n/g,"")).replace(/Ownership \& Use\n/g,"")).replace(/Trading\n/g,"")).replace(/Trade\n/g,"")).replace(/Historical Associations\n/g,"")).replace(/Other\n/g,"")).replace(/\n\n\n/g,"\n\n")).replace(/\n/g,"<br>")).replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,""),f=(f=(f=(f=f.replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,"");var g,p="https://www.pinterest.com/pin/create/button/",e=(p=(p+="?url="+u)+("&media="+d)+("&description="+o),""!=(r=void 0!==r&&null!=r?r:"")&&(p+=" ("+i+", "+r+")"),p+=", V%26A Collection",42<o.length&&(y("#title").addClass("reduced"),y("#piece-date").addClass("reduced")),y("#creator-name").text(a),y("#dates-alive").text(h),y("#title").html(o),""!=r&&y("#piece-date").text("("+r+")"),y("#place").html(i),y("#image").attr("src",d),y("#pinterest-button").attr("href",p),y("#page-link").attr("href",u),console.log("UI Updates - Setting title to:",o),console.log("UI Updates - Setting artist to:",a),console.log("UI Updates - Setting image to:",d),l&&""!==l.trim()?l:"No description available for this object.");y("#object-description").html("<p>"+e+"</p>"),y("#object-context").html("<p></p>"),y("#object-side-caption").html(m),""!=f?y("#physical-description").html(f):(console.log("hiding physical description"),y("#physical-description").hide(),y("#physical-description").prev("h4").hide()),""!=r?y("#tech-info-piece-date").text(r):(y("#tech-info-piece-date").hide(),y("#tech-info-piece-date").prev("h4").hide()),""!=a?y("#tech-info-creator-name").text(a):(y("#tech-info-creator-name").hide(),y("#tech-info-creator-name").prev("h4").hide()),y("#tech-info-materials").hide(),y("#tech-info-materials").prev("h4").hide(),""!=i?y("#tech-info-place").text(i):(y("#tech-info-place").hide(),y("#tech-info-place").prev("h4").hide()),y("#dimensions").hide(),y("#dimensions").prev("h4").hide(),""!=n?y("#museum-location").text(n):(y("#museum-location").hide(),y("#museum-location").prev("h4").hide()),""!=s?y("#museum-number").text(s):(y("#museum-number").hide(),y("#museum-number").prev("h4").hide()),E.onThrottledResize(),y(".content-placeholder, .hide-until-loaded").addClass("loaded"),y("img.image-hide-until-loaded").on("load",function(){y(".image-hide-until-loaded, .hide-after-loaded").addClass("loaded"),y(this).removeClass("image-error")}).on("error",function(){console.log("Image failed to load:",d),y(this).closest(".object-image-wrapper").html('<div class="image-placeholder"><p>Image not available</p><p><small>This object may not have been photographed yet, or the image may be temporarily unavailable.</small></p></div>'),y(".image-hide-until-loaded, .hide-after-loaded").addClass("loaded")}),0!==t&&1!==t&&((g=v.theHistory||[]).push({objectNumber:c,vaCollectionsUrl:u,imageUrl:d,title:o,date:r,artist:a,systemNumber:c}),g.length>(v.maxHistoryItems||10)&&g.shift(),v.theHistory=g,"undefined"!=typeof chrome)&&void 0!==chrome.storage&&chrome.storage.local.set({objectHistory:g},function(){console.log("History saved to storage:",g.length,"items")})}else console.log("No object found for system number, trying a different search term"),C(),T(null,b)}E.start=function(){var e;console.log("=== V&A API START FUNCTION CALLED ==="),console.log("looking for  user settings"),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage&&(console.log("Testing background script communication..."),chrome.runtime.sendMessage({action:"test"},function(e){console.log("Background script test response:",e)})),"undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.sync.get({userSearchTerms:"",strictSearch:"fuzzy"},function(e){t=0<e.userSearchTerms.length?(console.log("using user search terms: "+e.userSearchTerms),e.userSearchTerms.replace(/ /g,"+").split(",")):(console.log("using default search terms: "+n),n),console.log("strictSearch setting = "+e.strictSearch),"strict"==e.strictSearch&&(h=!0);e=t.join(", ");y("#search-terms").text(e),C(),T(null,b)}):(console.log("Running as standalone page, using default search terms: "+n),e=(t=n).join(", "),y("#search-terms").text(e),C(),T(null,b))},E.makeVaRequest=T,E.processResponse=f})(this,this.jQuery,this.Modernizr),((e,t)=>{e.pumkin=e.pumkin||{};var n=e.SITE=e.SITE||{};t(function(){console.log("=== DOCUMENT READY HANDLER EXECUTED ==="),n.initGlobal(),n.initMain(),n.start()})})(this,this.jQuery);