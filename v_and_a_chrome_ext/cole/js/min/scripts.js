function PointerEventsPolyfill(e){var n;this.options={selector:"*",mouseEvents:["click","dblclick","mousedown","mouseup"],usePolyfillIf:function(){if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;if(null!=e.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/))if(parseFloat(RegExp.$1)<11)return!0}return!1}},e&&(n=this,$.each(e,function(e,t){n.options[e]=t})),this.options.usePolyfillIf()&&this.register_mouse_events()}(()=>{for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=n.length,o=window.console=window.console||{};i--;)o[e=n[i]]||(o[e]=t)})(),window.Modernizr=function(e,h,u){function t(e){c.cssText=e}function d(e,t){return typeof e===t}function i(e,t){return!!~(""+e).indexOf(t)}function f(e,t){for(var n in e){n=e[n];if(!i(n,"-")&&c[n]!==u)return"pfx"!=t||n}return!1}function o(e,t,n){var i=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+v.join(i+" ")+i).split(" ");if(d(t,"string")||void 0===t)return f(o,t);var r,s=(e+" "+y.join(i+" ")+i).split(" "),a=t,c=n;for(r in s){var l=a[s[r]];if(l!==u)return!1===c?s[r]:d(l,"function")?l.bind(c||a):l}return!1}function r(e,t,n,i){var o,r,s,a=h.createElement("div"),c=h.body,l=c||h.createElement("body");if(parseInt(n,10))for(;n--;)(r=h.createElement("div")).id=i?i[n]:p+(n+1),a.appendChild(r);return o=["&#173;",'<style id="s',p,'">',e,"</style>"].join(""),a.id=p,(c?a:l).innerHTML+=o,l.appendChild(a),c||(l.style.background="",l.style.overflow="hidden",s=m.style.overflow,m.style.overflow="hidden",m.appendChild(l)),o=t(a,e),c?a.parentNode.removeChild(a):(l.parentNode.removeChild(l),m.style.overflow=s),!!o}var n,s,a={},m=h.documentElement,p="modernizr",c=h.createElement(p).style,l=" -webkit- -moz- -o- -ms- ".split(" "),g="Webkit Moz O ms",v=g.split(" "),y=g.toLowerCase().split(" "),b={},w=[],E=w.slice,C={}.hasOwnProperty,T=void 0!==C&&void 0!==C.call?function(e,t){return C.call(e,t)}:function(e,t){return t in e&&void 0===e.constructor.prototype[t]};for(s in Function.prototype.bind||(Function.prototype.bind=function(n){var i=this;if("function"!=typeof i)throw new TypeError;var o=E.call(arguments,1),r=function(){var e,t;return this instanceof r?((e=function(){}).prototype=i.prototype,e=new e,t=i.apply(e,o.concat(E.call(arguments))),Object(t)===t?t:e):i.apply(n,o.concat(E.call(arguments)))};return r}),b.canvas=function(){var e=h.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},b.touch=function(){var t;return"ontouchstart"in e||e.DocumentTouch&&h instanceof DocumentTouch?t=!0:r(["@media (",l.join("touch-enabled),("),p,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){t=9===e.offsetTop}),t},b.rgba=function(){return t("background-color:rgba(150,255,150,.5)"),i(c.backgroundColor,"rgba")},b.cssanimations=function(){return o("animationName")},b.csstransforms=function(){return!!o("transform")},b.csstransforms3d=function(){var n=!!o("perspective");return n&&"webkitPerspective"in m.style&&r("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e,t){n=9===e.offsetLeft&&3===e.offsetHeight}),n},b.csstransitions=function(){return o("transition")},b)T(b,s)&&(n=s.toLowerCase(),a[n]=b[s](),w.push((a[n]?"":"no-")+n));a.addTest=function(e,t){if("object"==typeof e)for(var n in e)T(e,n)&&a.addTest(n,e[n]);else{if(e=e.toLowerCase(),a[e]!==u)return a;t="function"==typeof t?t():t,m.className+=" "+(t?"":"no-")+e,a[e]=t}return a},t("");var g=this,j=h;function k(){var e=M.elements;return"string"==typeof e?e.split(" "):e}function L(e){var t=H[e[N]];return t||(t={},O++,e[N]=O,H[O]=t),t}function x(e,t,n){return t=t||j,$?t.createElement(e):!(t=(n=n||L(t)).cache[e]?n.cache[e].cloneNode():_.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e)).canHaveChildren||z.test(e)||t.tagUrn?t:n.frag.appendChild(t)}function P(e){var t,n,i,o,r,s=L(e=e||j);return!M.shivCSS||I||s.hasCSS||(s.hasCSS=(o="article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}",r=(i=e).createElement("p"),i=i.getElementsByTagName("head")[0]||i.documentElement,r.innerHTML="x<style>"+o+"</style>",!!i.insertBefore(r.lastChild,i.firstChild))),$||(t=e,(n=s).cache||(n.cache={},n.createElem=t.createElement,n.createFrag=t.createDocumentFragment,n.frag=n.createFrag()),t.createElement=function(e){return M.shivMethods?x(e,t,n):n.createElem(e)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+k().join().replace(/[\w\-]+/g,function(e){return n.createElem(e),n.frag.createElement(e),'c("'+e+'")'})+");return n}")(M,n.frag)),e}var I,$,S,A=g.html5||{},z=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,_=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,N="_html5shiv",O=0,H={};try{var D=j.createElement("a");D.innerHTML="<xyz></xyz>",I="hidden"in D,$=1==D.childNodes.length||(j.createElement("a"),void 0===(S=j.createDocumentFragment()).cloneNode)||void 0===S.createDocumentFragment||void 0===S.createElement}catch(e){$=I=!0}var M={elements:A.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==A.shivCSS,supportsUnknownElements:$,shivMethods:!1!==A.shivMethods,type:"default",shivDocument:P,createElement:x,createDocumentFragment:function(e,t){if(e=e||j,$)return e.createDocumentFragment();for(var n=(t=t||L(e)).frag.cloneNode(),i=0,o=k(),r=o.length;i<r;i++)n.createElement(o[i]);return n}};return g.html5=M,P(j),a._version="2.7.1",a._prefixes=l,a._domPrefixes=y,a._cssomPrefixes=v,a.testProp=function(e){return f([e])},a.testAllProps=o,a.testStyles=r,m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(" js "+w.join(" ")),a}(this,this.document),(d=>{var f={},n="doTimeout",m=Array.prototype.slice;function i(e){var t,n=this,i={},o=e?d.fn:d,r=arguments,s=4,a=r[1],c=r[2],l=r[3];function h(){e?t.removeData(e):a&&delete f[a]}function u(){i.id=setTimeout(function(){i.fn()},c)}if("string"!=typeof a&&(s--,a=e=0,c=r[1],l=r[2]),e?(t=n.eq(0)).data(e,i=t.data(e)||{}):a&&(i=f[a]||(f[a]={})),i.id&&clearTimeout(i.id),delete i.id,l)i.fn=function(e){(!0!==(l="string"==typeof l?o[l]:l).apply(n,m.call(r,s))||e?h:u)()},u();else{if(i.fn)return void 0===c?h():i.fn(!1===c),!0;h()}}d[n]=function(){return i.apply(window,[0].concat(m.call(arguments)))},d.fn[n]=function(){var e=m.call(arguments),t=i.apply(this,[n+e[0]].concat(e));return"number"==typeof e[0]||"number"==typeof e[1]?this:t}})(jQuery),((e,h)=>{var i,t=e.jQuery||e.Cowboy||(e.Cowboy={});t.throttle=i=function(o,r,s,a){var c,l=0;function e(){var e=this,t=+new Date-l,n=arguments;function i(){l=+new Date,s.apply(e,n)}a&&!c&&i(),c&&clearTimeout(c),a===h&&o<t?i():!0!==r&&(c=setTimeout(a?function(){c=h}:i,a===h?o-t:o))}return"boolean"!=typeof r&&(a=s,s=r,r=h),t.guid&&(e.guid=s.guid=s.guid||t.guid++),e},t.debounce=function(e,t,n){return n===h?i(e,t,!1):i(e,n,!1!==t)}})(this),PointerEventsPolyfill.initialize=function(e){return null==PointerEventsPolyfill.singleton&&(PointerEventsPolyfill.singleton=new PointerEventsPolyfill(e)),PointerEventsPolyfill.singleton},PointerEventsPolyfill.prototype.register_mouse_events=function(){$(document).on(this.options.mouseEvents.join(" "),this.options.selector,function(e){var t,n;return"none"!=$(this).css("pointer-events")||(t=$(this).css("display"),$(this).css("display","none"),n=document.elementFromPoint(e.clientX,e.clientY),t?$(this).css("display",t):$(this).css("display",""),e.target=n,$(n).trigger(e),!1)})},function(){function e(){}function r(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function t(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,i=this,o=i.EventEmitter;n.getListeners=function(e){var t,n,i=this._getEvents();if("object"==typeof e)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},n.flattenListeners=function(e){for(var t=[],n=0;e.length>n;n+=1)t.push(e[n].listener);return t},n.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},n.addListener=function(e,t){var n,i=this.getListenersAsObject(e),o="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===r(i[n],t)&&i[n].push(o?t:{listener:t,once:!1});return this},n.on=t("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=t("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,t){var n,i,o=this.getListenersAsObject(e);for(i in o)o.hasOwnProperty(i)&&(n=r(o[i],t),-1!==n)&&o[i].splice(n,1);return this},n.off=t("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,n){var i,o,r=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)r.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(o=t[i])&&("function"==typeof o?r:s).call(this,i,o);return this},n.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"==n)delete i[e];else if("object"==n)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},n.removeAllListeners=t("removeEvent"),n.emitEvent=function(e,t){var n,i,o,r,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=s[o].length;i--;)n=s[o][i],!0===n.once&&this.removeListener(e,n.listener),r=n.listener.apply(this,t||[]),r===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},n.trigger=t("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=o,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),(n=>{function i(e){var t=n.event;return t.target=t.target||t.srcElement||e,t}var e=document.documentElement,t=function(){},o=(e.addEventListener?t=function(e,t,n){e.addEventListener(t,n,!1)}:e.attachEvent&&(t=function(t,e,n){t[e+n]=n.handleEvent?function(){var e=i(t);n.handleEvent.call(n,e)}:function(){var e=i(t);n.call(t,e)},t.attachEvent("on"+e,t[e+n])}),function(){}),e=(e.removeEventListener?o=function(e,t,n){e.removeEventListener(t,n,!1)}:e.detachEvent&&(o=function(t,n,i){t.detachEvent("on"+n,t[n+i]);try{delete t[n+i]}catch(e){t[n+i]=void 0}}),{bind:t,unbind:o});"function"==typeof define&&define.amd?define("eventie/eventie",e):n.eventie=e})(this),((n,i)=>{"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(e,t){return i(n,e,t)}):"object"==typeof exports?module.exports=i(n,require("eventEmitter"),require("eventie")):n.imagesLoaded=i(n,n.EventEmitter,n.eventie)})(this,function(e,t,n){function o(e,t){for(var n in t)e[n]=t[n];return e}function r(e){var t=[];if("[object Array]"===u.call(e))t=e;else if("number"==typeof e.length)for(var n=0,i=e.length;n<i;n++)t.push(e[n]);else t.push(e);return t}function s(e,t,n){if(!(this instanceof s))return new s(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=r(e),this.options=o({},this.options),"function"==typeof t?n=t:o(this.options,t),n&&this.on("always",n),this.getImages(),c&&(this.jqDeferred=new c.Deferred);var i=this;setTimeout(function(){i.check()})}function i(e){this.img=e}function a(e){this.src=e,d[e]=this}var c=e.jQuery,l=e.console,h=void 0!==l,u=Object.prototype.toString,d=((s.prototype=new t).options={},s.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;e<t;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),o=0,r=i.length;o<r;o++){var s=i[o];this.addImage(s)}}},s.prototype.addImage=function(e){e=new i(e);this.images.push(e)},s.prototype.check=function(){function e(e,t){return n.options.debug&&h&&l.log("confirm",e,t),n.progress(e),++i===o&&n.complete(),!0}var n=this,i=0,o=this.images.length;if(this.hasAnyBroken=!1,o)for(var t=0;t<o;t++){var r=this.images[t];r.on("confirm",e),r.check()}else this.complete()},s.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done",n=(this.isComplete=!0,this);setTimeout(function(){var e;n.emit(t,n),n.emit("always",n),n.jqDeferred&&(e=n.hasAnyBroken?"reject":"resolve",n.jqDeferred[e](n))})},c&&(c.fn.imagesLoaded=function(e,t){return new s(this,e,t).jqDeferred.promise(c(this))}),(i.prototype=new t).check=function(){var n,e=d[this.img.src]||new a(this.img.src);e.isConfirmed?this.confirm(e.isLoaded,"cached was confirmed"):this.img.complete&&void 0!==this.img.naturalWidth?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(n=this,e.on("confirm",function(e,t){return n.confirm(e.isLoaded,t),!0}),e.check())},i.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)},{});return(a.prototype=new t).check=function(){var e;this.isChecked||(e=new Image,n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0)},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},a.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},a.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},a.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},s}),(t=>{t.fn.fittr=function(e){window.console&&window.console.log;var c=t.extend({container:"div",imgWidth:0,imgHeight:0,containerWidth:0,containerHeight:0,gap:{vertical:0,horizontal:0},align:{vertical:"top",horizontal:"left"},resizeType:"fit",autoResize:!0,forceDebounce:!1},e);return c.gap.vertical||(c.gap.vertical=0),c.gap.horizontal||(c.gap.horizontal=0),c.align.vertical||(c.align.vertical="top"),c.align.horizontal||(c.align.horizontal="left"),this.each(function(){var r=t(this),s=r.parents(c.container).first(),a=1;function e(){var e={width:0<parseInt(r.attr("width"))?parseInt(r.attr("width")):r.width(),height:0<parseInt(r.attr("height"))?parseInt(r.attr("height")):r.height()},t=0<c.imgWidth?c.imgWidth:e.width,e=0<c.imgHeight?c.imgHeight:e.height,n=0<c.containerWidth?c.containerWidth:s.width(),i=0<c.containerHeight?c.containerHeight:s.height(),o={width:n-c.gap.horizontal,height:i-c.gap.vertical},t=t/e,e=o.width/o.height;e="fit"==c.resizeType?{width:o.width<=o.height*t?o.width:o.height*t,height:o.width<=o.height*t?o.width/t:o.height,marginLeft:0,marginTop:0}:(s.css("overflow","hidden"),{width:e<=t?o.height*t:o.width,height:e<=t?o.height:o.width/t,marginLeft:0,marginTop:0}),"right"==c.align.horizontal?e.marginLeft=n-e.width:"center"==c.align.horizontal&&(e.marginLeft=(n-e.width)/2),"bottom"==c.align.vertical?e.marginTop=i-e.height:"middle"==c.align.vertical&&(e.marginTop=(i-e.height)/2),r.css(e),a++}e(),1==c.autoResize&&(10<a||1==c.forceDebounce?t(window).smartresize(e):t(window).resize(e))})}})(jQuery),(t=>{jQuery.fn[t]=function(e){return e?this.bind("resize",(n=e,function(){var e=this,t=arguments;r?clearTimeout(r):o&&n.apply(e,t),r=setTimeout(function(){o||n.apply(e,t),r=null},i||100)})):this.trigger(t);var n,i,o,r}})((jQuery,"smartresize"));var pumkin=window.pumkin={};((t,T,n)=>{pumkin={getTransformValues:function(e,t){var n=(e=e.css("transform").match(/-?[0-9\.]+/g))[0];return"scale"===t?n:"translate"===t?{x:e[4]/n,y:e[5]/n}:"raw"===t?e:void 0},checkKey:function(e){return(e=e||t.event).keyCode},svgFallback:function(){T("img[src$='.svg']").each(function(){var e=T(this),t=e.attr("src").replace(".svg",".png");e.attr("src",t)})},normalizeBoxHeights:function(e){var t=0;e.each(function(){t=Math.max(T(this).height(),t)}),e.each(function(){T(this).height(t)})},randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},autoFit:function(e,t,n,i,o,r,s){console.log("autoFit: "+t.length),n=n||0;for(var a=e.width()-n,c=(t.removeAttr("style"),[]),l=0,h=[],u=(t.each(function(){var e=T(this);(l+=parseInt(e.css("width"))+n)<=a?h.push(e):(c.push(h),h=new Array(e),l=parseInt(e.css("width"))+n),e.is(":last-child")&&o&&c.push(h)}),c.length),d=0;d<u;d++){for(var f=c[d].length,m=0,p=0;p<f;p++)m+=parseInt(c[d][p].css("width"))+n;var g=(a-m)/f,v=m/f,y=0;for(s&&parseInt(c[0][0].css("width")),p=0;p<f;p++){var b,w=parseInt(c[d][p].css("width")),E=s?w+g:w+Math.floor(g*(w/v));0===d&&0===p&&(b=parseInt(c[d][p].css("height")),b=i?Math.floor(E*(b/w)):b),r?c[d][p].css({width:E}):c[d][p].css({width:E,height:b}),y+=E+n}var C=a-y;c[d][f-1].css("width",parseInt(c[d][f-1].css("width"))+C)}},defineDeviceVariables:function(){var e={isMobile:"visible"===T("#mobileTester").css("visibility"),isTablet:"visible"===T("#tabletTester").css("visibility"),isTouch:!!n.touch};return e.isDevice=!(!e.isMobile&&!e.isTablet),e},browserDetection:function(){var e={};return e.isChrome=-1<navigator.userAgent.indexOf("Chrome"),e.isExplorer=-1<navigator.userAgent.indexOf("MSIE"),e.isFirefox=-1<navigator.userAgent.indexOf("Firefox"),e.isSafari=-1<navigator.userAgent.indexOf("Safari"),e.isOpera=-1<navigator.userAgent.indexOf("Presto"),e.isChrome&&e.isSafari&&(e.isSafari=!1),e},makePlaceholders:function(e,n){n=n||"active",T(e).each(function(){var e=T(this),t=e.data().placeholder;e.val(t),""===T.trim(e.val())&&e.val(t).removeClass(n),e.focus(function(){e.val()===t&&e.val("").addClass(n)}).blur(function(){""===T.trim(e.val())&&e.val(t).removeClass(n)})})},intelliLoad:function(e,t,n){n="function"==typeof imagesLoaded&&n,e.each(function(){var e=T(this),t=e.data("src");n&&e.css({opacity:0}),e.attr("src")||(e.attr("src",t),console.log("INTELLILOAD: is image?"+e.is("img")),n&&e.is("img")&&(console.log("INTELLILOAD: revlealOnLoad: "+t),e.imagesLoaded().done(function(e,t){console.log("INTELLILOAD: imagesLoaded: "+t.attr("src")),t.css({opacity:1})})))})}}})(this,this.jQuery,this.Modernizr),((e,t)=>{var n=e.pumkin;(e.SITE=e.SITE||{}).initGlobal=function(){e.gv={$window:t(e),$document:t(document),$html:t("html"),$body:t("body"),WIDTH:t(e).width(),HEIGHT:t(e).height(),deviceVariables:n.defineDeviceVariables(),browser:n.browserDetection(),$wrapper:t("#wrapper")},console.log("initGlobal")}})(this,this.jQuery,this.Modernizr),((t,i,n)=>{t.pumkin;var e=t.SITE=t.SITE||{},o=null,r=null;function s(){var n;i(".history-wrapper .loading").addClass("loaded"),n=0,theHistory.forEach(function(e){var t="",t=(t=(t=(t=(t=(t+='<a class="history-object hide-until-loaded" data-object-number="'+e.objectNumber+'" href="'+e.vaCollectionsUrl+'"')+'title="View this item in the V&amp;A archive">'+'<div class="history-object-image-holder" ')+("style=\"background-image: url('"+e.imageUrl+"');\">")+"</div>")+('<img src="'+e.imageUrl+'" class="image-holder-for-loading" id="image-holder-'+n+'" >')+'<div class="history-object-info">')+("<p><strong>"+e.title+"</strong>, "+e.date+"</p>")+("<p>"+e.artist+"</p>"))+"</div>"+"</a";i("#history-objects").append(t),i("#image-holder-"+n).on("load",function(){i(this).parent().addClass("loaded"),i(this).remove()}),n++})}function a(){var e=$textContent.scrollTop();.5*r<e?$objectCaption.addClass("reveal"):$objectCaption.removeClass("reveal"),.5*r<e?$objectHeader.addClass("hide"):$objectHeader.removeClass("hide")}function c(){a()}function l(){o.width(),r=o.height()}function h(){}var u=i.throttle(250,function(){}),d=i.debounce(100,function(){});e.initMain=function(){var e;e=t.gv,o=e.$window,r=e.HEIGHT,e.deviceVariables.isMobile,e.deviceVariables.isTablet,e.deviceVariables.isDevice,e.deviceVariables.isTouch,$textContent=i(".text-content-column"),$objectCaption=i(".object-caption"),$downArrow=i(".down-arrow"),$objectHeader=i(".object-header"),$sidePanel=i(".side-panel"),$sidePanelOpenBtn=i(".more"),$sidePanelCloseBtn=i(".close-side-panel"),$historyOpenBtn=i(".history"),$overlayCloseBtn=i(".close-overlay"),$overlay=i(".overlay"),$techInfo=i(".technical-info .text-content"),void 0!==n&&n&&n.attach(document.body),$sidePanelOpenBtn.click(function(){$sidePanel.hasClass("open")?$sidePanel.removeClass("open"):$sidePanel.addClass("open")}),$sidePanelCloseBtn.click(function(){$sidePanel.removeClass("open")}),$downArrow.click(function(){i(".object-text").velocity("scroll",{duration:700,offset:-100,easing:"ease-in-out",container:$textContent})}),$historyOpenBtn.click(function(){$overlay.hasClass("closed")&&($overlay.removeClass("closed").addClass("open for-history"),s(),$overlay.fadeIn(500))}),$overlayCloseBtn.click(function(){$overlay.fadeOut(500,function(){$overlay.removeClass("open for-history for-warning").addClass("closed")})}),i(".go-to-options").click(function(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():t.open(chrome.runtime.getURL("/src/options/index.html"))}),l(),o.on("resize",l),o.on("resize",u),o.on("resize",d),a(),$textContent.on("scroll",c),console.log("initMain")},e.throwError=function(){$overlay.removeClass("closed").addClass("open for-warning"),$overlay.fadeIn(500)},e.onThrottledResize=h,e.showHistory=s,e.hideHistory=function(){i("#history-objects").text("")}})(this,this.jQuery,(this.Modernizr,this.screenfull,this.FastClick)),((e,m)=>{var t,p,g=e.pumkin,v=e.SITE=e.SITE||{},y="https://collections.vam.ac.uk/item/",n=["Architecture","Asia","British Galleries","Ceramics","Childhood","Contemporary","Fashion","Jewellery","Furniture","Glass","Metalwork","Paintings","Drawings","Photography","Prints","Books","Sculpture","Textiles","Theatre"],h=!1,u=0,d=5;function b(){p=t[g.randomNum(0,t.length)],console.log("Chosen search term: "+p+" from "+t.length+" available terms")}function w(e,t,n,i,o,r,s,a){var c,l;u<d?(u++,e=void 0!==e?e:null,o=void 0!==o?o:"1",i=void 0!==i?i:"1",t=void 0!==t?t:null,n=void 0!==n?n:null,r=void 0!==r?r:"1",s=void 0!==s?s:null,a=void 0!==a?a:"0",quality="undefined"!=typeof quality?quality:null,c=0,null!=n?c=1:null!=e&&(c=2),1==h?(l=t,t=null):l=null,console.log("strictSearch = "+h),console.log("expectResponse = "+c),console.log("Chosen term = "+t),console.log("Chosen item name = "+l),console.log("offset = "+n),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage?(console.log("Sending message to background script..."),chrome.runtime.sendMessage({action:"makeVaRequest",params:{systemNumber:e,searchTerm:t||l,offset:n,limit:i,withImages:o,withDescription:r,after:s,random:a}},function(e){console.log("Received response from background script:",e),e&&e.success?(console.log("API request successful"),f(e.data,c)):(console.log("API request failed:",e?e.error:"No response"),b(),w(null,p))})):(console.log("Running as standalone page - API requests will fail due to CORS"),v.throwError())):(console.log("maximum number of search attempts reached, try changing search terms"),v.throwError())}function f(e,t){var n,i,o,r,s,a,c,l,h,u,d,f;console.log(e),0===t?0<(a=e.records.length)?(f=g.randomNum(0,e.info.record_count-1),console.log("total results = "+e.info.record_count),console.log("randomOffset range: 0 to "+(e.info.record_count-1)),console.log("generated randomOffset = "+f),console.log("making query 2, with randomOffset of "+f),w(null,p,f)):(console.log("making a second request, no results found last time"),b(),w(null,p)):1===t?(a=e.records.length,console.log("There are "+a+" objects available."),f=e.records[0].systemNumber,console.log("Selected object system number: "+f),w(f)):e.records&&0!==e.records.length?(t=e.records[0],console.log("Processing object data:",t),a=t._primaryImageId,f=t.objectType,e=""!=t._primaryTitle?t._primaryTitle:t.objectType,n=t._primaryDate,l=t.systemNumber,i=t._primaryMaker&&t._primaryMaker.name?t._primaryMaker.name:"",c=t.systemNumber,u="",console.log("Extracted data - Title:",e,"Artist:",i,"System Number:",c),o="",t._primaryMaker&&t._primaryMaker.birthYear&&(s=t._primaryMaker.birthYear,r=t._primaryMaker.deathYear,s&&r?o="("+s+" - "+r+")":s&&(o="(Born "+s+")")),r="https://framemark.vam.ac.uk/collections/"+a+"/full/1000,/0/default.jpg",s=y+c+"/"+l,a=t._primaryPlace,c=t.accessionNumber,l=t._currentLocation?t._currentLocation.displayName:"",h="<strong>"+(e=(e=(e=(e=(e=e.replace(/\^/,t="")).replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,""))+" "+n+"</strong> &mdash; "+i+" "+o,d=[],e&&e!==f&&d.push(e),n&&d.push("Dated "+n),a&&d.push("from "+a),i&&"Unknown"!==i&&d.push("by "+i),u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=(u=0<d.length?d.join(", ")+".":"A "+f+" from the V&A collection.").replace(/Object Type\n/g,"")).replace(/People\n/g,"")).replace(/Place\n/g,"")).replace(/Places\n/g,"")).replace(/Time\n/g,"")).replace(/Design \& Designing\n/g,"")).replace(/Design\n/g,"")).replace(/Subject Depicted\n/g,"")).replace(/Subjects Depicted\n/g,"")).replace(/Materials \& Making\n/g,"")).replace(/Collectors \& Owners\n/g,"")).replace(/Ownership \& Use\n/g,"")).replace(/Trading\n/g,"")).replace(/Trade\n/g,"")).replace(/Historical Associations\n/g,"")).replace(/Other\n/g,"")).replace(/\n\n\n/g,"\n\n")).replace(/\n/g,"<br>")).replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,""),t=(t=(t=(t=t.replace(/\<i\>/g,"")).replace(/\<\\i\>/g,"")).replace(/\<b\>/g,"")).replace(/\<\\b\>/g,""),d="https://www.pinterest.com/pin/create/button/",d=(d+="?url="+s)+"&media="+r+"&description="+e,""!=(n=void 0!==n&&null!=n?n:"")&&(d+=" ("+a+", "+n+")"),d+=", V%26A Collection",42<e.length&&(m("#title").addClass("reduced"),m("#piece-date").addClass("reduced")),m("#creator-name").text(i),m("#dates-alive").text(o),m("#title").html(e),""!=n&&m("#piece-date").text("("+n+")"),m("#place").html(a),m("#image").attr("src",r),m("#pinterest-button").attr("href",d),m("#page-link").attr("href",s),console.log("UI Updates - Setting title to:",e),console.log("UI Updates - Setting artist to:",i),console.log("UI Updates - Setting image to:",r),f=u&&""!==u.trim()?u:"No description available for this object.",m("#object-description").html("<p>"+f+"</p>"),m("#object-context").html("<p></p>"),m("#object-side-caption").html(h),""!=t?m("#physical-description").html(t):(console.log("hiding physical description"),m("#physical-description").hide(),m("#physical-description").prev("h4").hide()),""!=n?m("#tech-info-piece-date").text(n):(m("#tech-info-piece-date").hide(),m("#tech-info-piece-date").prev("h4").hide()),""!=i?m("#tech-info-creator-name").text(i):(m("#tech-info-creator-name").hide(),m("#tech-info-creator-name").prev("h4").hide()),m("#tech-info-materials").hide(),m("#tech-info-materials").prev("h4").hide(),""!=a?m("#tech-info-place").text(a):(m("#tech-info-place").hide(),m("#tech-info-place").prev("h4").hide()),m("#dimensions").hide(),m("#dimensions").prev("h4").hide(),""!=l?m("#museum-location").text(l):(m("#museum-location").hide(),m("#museum-location").prev("h4").hide()),""!=c?m("#museum-number").text(c):(m("#museum-number").hide(),m("#museum-number").prev("h4").hide()),v.onThrottledResize(),m(".content-placeholder, .hide-until-loaded").addClass("loaded"),m("img.image-hide-until-loaded").load(function(){m(".image-hide-until-loaded, .hide-after-loaded").addClass("loaded")})):(console.log("No object found for system number, trying a different search term"),b(),w(null,p))}v.start=function(){console.log("=== V&A API START FUNCTION CALLED ==="),console.log("looking for  user settings"),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage&&(console.log("Testing background script communication..."),chrome.runtime.sendMessage({action:"test"},function(e){console.log("Background script test response:",e)})),"undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.sync.get({userSearchTerms:"",strictSearch:"fuzzy"},function(e){t=0<e.userSearchTerms.length?(console.log("using user search terms: "+e.userSearchTerms),e.userSearchTerms.replace(/ /g,"+").split(",")):(console.log("using default search terms: "+n),n),console.log("strictSearch setting = "+e.strictSearch),"strict"==e.strictSearch&&(h=!0),b(),w(null,p)}):(console.log("Running as standalone page, using default search terms: "+n),t=n,b(),w(null,p))},v.makeVaRequest=w,v.processResponse=f})(this,this.jQuery,this.Modernizr),((e,t)=>{e.pumkin=e.pumkin||{};var n=e.SITE=e.SITE||{};t(function(){console.log("=== DOCUMENT READY HANDLER EXECUTED ==="),n.initGlobal(),n.initMain(),n.start()})})(this,this.jQuery);